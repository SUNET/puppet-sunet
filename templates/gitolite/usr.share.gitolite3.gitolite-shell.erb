# Last Modified: Sat Mar  9 18:20:47 2019
#include <tunables/global>

/usr/share/gitolite3/gitolite-shell {
  #include <abstractions/base>
  #include <abstractions/bash>
  #include <abstractions/perl>

  /bin/dash rix,
  /bin/grep rix,
  /bin/hostname rix,
  /bin/mktemp rix,
  /bin/mv rix,
  /bin/rm rix,
  /bin/sed rix,
  /etc/ssl/openssl.cnf r,
  /lib/x86_64-linux-gnu/ld-*.so mr,
  @{PROC}/@{pid}/loginuid r,
  /usr/bin/cut rix,
  /usr/bin/find rix,
  /usr/bin/git mr,
  /usr/bin/git rix,
  /usr/bin/gitolite rix,
  /usr/bin/logger rix,
  /usr/bin/perl ix,
  /usr/bin/sort rix,
  /usr/bin/ssh-keygen rix,
  /usr/lib/git-core/git rix,
  /usr/lib/git-core/git-shell rix,
  /usr/lib/git-core/git-upload-pack rix,
  /usr/share/git-core/** r,
  /usr/share/gitolite3/** r,
  /usr/share/gitolite3/commands/* rix,
  /usr/share/gitolite3/triggers/*/* rix,
  /@{HOME}/ r,
  /@{HOME}/.gitolite.rc r,
  /@{HOME}/.gitolite/ r,
  /@{HOME}/.gitolite/** rw,
  /@{HOME}/.gitolite/hooks/*/* rix,
  /@{HOME}/.ssh/authorized_keys rw,
  /@{HOME}/.ssh/authorized_keys.* rw,
  /@{HOME}/projects.list rw,
  /@{HOME}/projects.list.* rw,
  /@{HOME}/repositories/ r,
  /@{HOME}/repositories/** rwl,

}
