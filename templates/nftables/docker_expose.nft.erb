#
# DNAT packets to an exposed service running in a Docker container
#
add rule ip nat prerouting iif eth0 tcp <%= @dport %> dnat to 172.16.0.2 comment "<%= @name %>"
add rule ip6 nat prerouting iif eth0 tcp <%= @dport %> dnat to fd00::2 comment "<%= @name %>"

#
# Allow forwarding of the packets to the exposed service
#
add rule inet filter forward ip saddr { <%= @allow_clients_v4.join(', ') %> }  tcp <%= @dport %> counter accept comment "<%= @name %>"
add rule inet filter forward ip6 saddr { <%= @allow_clients_v6.join(', ') %> }  tcp <%= @dport %> counter accept comment "<%= @name %>"
