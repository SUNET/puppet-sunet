version: '3.2'
services:
<% numnodesmone = @numnodes - 1 -%>
<% for i in 0..numnodesmone -%>
<% clusterport = 7000 + i %>
<% redisport = 6379 + i %>
  redis-node-<%= i %>:
    container_name: redis-node-<%= i %>
    image: redis:7-bullseye
    network_mode: host
    dns:
      - 89.46.20.75
      - 89.46.21.29
      - 89.32.32.32
    ports:
      - "<%= redisport %>:<%= redisport %>"
      - "<%= clusterport %>:<%= clusterport %>"
    volumes:
      - /opt/redis/node-<%= i %>:/data
    command: redis-server /data/server.conf
    restart: always
<% end %>
