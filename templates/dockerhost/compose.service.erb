# This service file is generated by Puppet. Do not edit.
#
# This information is used by check_docker_containers to monitor the started containers:
# COMPOSE_FILE=<%= @compose_file %>
#
[Unit]
Description=<%= @description %>
After=docker.service
BindsTo=docker.service
Conflicts=shutdown.target reboot.target halt.target

[Service]
TimeoutStartSec=0
TimeoutStopSec=30
Restart=always
RestartSec=10

SyslogIdentifier=<%= @_service_name %>

WorkingDirectory=/

# To make docker pull work with basic-auth credentials
Environment="HOME=/root"

ExecStartPre=-/usr/local/bin/docker-compose -f <%= @compose_file %> down
ExecStartPre=-/usr/local/bin/docker-compose -f <%= @compose_file %> kill
ExecStartPre=-/usr/local/bin/docker-compose -f <%= @compose_file %> rm
ExecStartPre=-/usr/local/bin/docker-compose -f <%= @compose_file %> rm -f
<% if @pull_on_start != true -%>#<% end -%>ExecStartPre=-/usr/local/bin/docker-compose -f <%= @compose_file %> pull

ExecStart=/usr/local/bin/docker-compose -f <%= @compose_file %> up --force-recreate --no-deps

ExecStop=/usr/local/bin/docker-compose -f <%= @compose_file %> stop

NotifyAccess=all

[Install]
WantedBy=multi-user.target
