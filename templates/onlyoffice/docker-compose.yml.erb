version: '3.2'

services:

    document-server:
      image: <%= @docker_image %>:<%= @docker_tag %>
      networks:
        - default
<% if @external_network -%>
        - <%= @external_network %>
<% end -%>
      dns:
        - 89.32.32.32
      ports:
        - "<%= @port %>:80"
        - "<%= @tls_port %>:443"
      volumes:
        - "<%= @basedir %>/logs:/var/log/onlyoffice"
        - "<%= @basedir %>/data:/var/www/onlyoffice/Data"
        - "<%= @basedir %>/lib:/var/lib/onlyoffice"
      environment:
        <%- @ds_environment.each do |environ| -%>
        - "<%= environ %>"
        <%- end -%>
      restart: always
<% if @external_network -%>
networks:
  <%= @external_network %>:
    external: true
<% end -%>
