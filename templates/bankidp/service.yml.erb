server:
  port: 8082

spring:
  data:
    redis:
        cluster:
          nodes: <% @redises.each do |host| -%><%= host %>:6379,<%- end %>
      ssl:
        enabled: false
      #password: '<%= scope.call_function('safe_hiera', ['bankidp_spring_redis_password']) %>'
      #ssl: false
      #ssl-ext:
      #  enable-hostname-verification: true
      #  credential:
      #    resource: file:/opt/bankidp/config/redis/redis.p12
      #    password: '<%= scope.call_function('safe_hiera', ['bankidp_spring_redis_p12_password']) %>'
      #  trust:
      #    resource: file:/opt/bankidp/config/redis/trust.p12
      #    password: '<%= scope.call_function('safe_hiera', ['bankidp_spring_redis_p12_password']) %>'
      #

bankid:
  session:
    module: redis
  audit:
    repository: "redistimeseries"
    log-file: /opt/bankidp/logs/audit.log

<% if @prod == true %>
  server-root-certificate: classpath:bankid-trust-prod.crt
  service-url: https://appapi2.bankid.com/rp/v6.0
<% else %>
  server-root-certificate: classpath:bankid-trust-test.crt
  service-url: https://appapi2.test.bankid.com/rp/v6.0
<% end %>

  ui:
    provider:
      svg-logotype: file:/opt/bankidp/config/logo-notext.svg
      name:
        sv: "Sweden Connect"
        en: "Sweden Connect"
    user-error:
      contact-email: operations@swedenconnect.se
      show-contact-information: false
      show-trace-id: true
    user-message-defaults:
      fallback-sign-text:
        text: "Jag skriver härmed under den information som visades på föregående sida."
        format: plain-text
      login-text:
        text: "*Tänk på!* Logga aldrig in med ditt BankID då någon ringer och ber dig logga in."
        format: simple-markdown-v1
  relying-parties:
    - id: "sunet"
      entity-ids:
       - "https://ladok3-00.ladok.umu.se/student-sp"
       - "https://ladok3-demo-00.its.umu.se/student-sp"
       - "https://release-check.qa.swamid.se/shibboleth"
      credential:
        name: "test-cred"
        resource: file:/opt/bankidp/config/sunet3.p12
        alias: "ALIAS"
        password: "qwerty123"

saml:
  idp:
    entity-id: '<%= scope.call_function('safe_hiera', ['bankidp_saml_base_url'])  %>'
    base-url: '<%= scope.call_function('safe_hiera', ['bankidp_saml_base_url'])  %>'
    metadata-providers:
<% if @prod == true %>
      - location: https://mds.swamid.se
        validation-certificate: file:/opt/bankidp/config/certificates/md-signer2.crt
<% else %>
      - location: https://mds.swamid.se/qa
        validation-certificate: file:/opt/bankidp/config/certificates/swamid-qa.crt
<% end -%>
        backup-location: /opt/bankidp/config/metadata/mdq-backup
        mdq: true
    credentials:
      sign:
        resource: file:/opt/bankidp/config/idp-keystore.jks
        alias: METADATA
        password: '<%= scope.call_function('safe_hiera', ['bankidp_saml_cert_password'])  %>'
        type: JKS
      encrypt:
        resource: file:/opt/bankidp/config/idp-keystore.jks
        alias: METADATA
        password: '<%= scope.call_function('safe_hiera', ['bankidp_saml_cert_password'])  %>'
        type: JKS
      metadata-sign:
        resource: file:/opt/bankidp/config/idp-keystore.jks
        alias: METADATA
        password: '<%= scope.call_function('safe_hiera', ['bankidp_saml_cert_password'])  %>'
        type: JKS
    metadata:
      ui-info:
        display-names:
          en: BankID
          sv: BankID
        descriptions:
          en: BankID Identity Provider (Sandbox)
          sv: BankID legitimeringstjänst (Sandbox)
        logotypes:
        - path: /images/BankID_logo.svg
          height: 171
          width: 20
      organization:
        names:
          en: "Sweden Connect"
          sv: "Sweden Connect"
        display-names:
          en: "Sweden Connect"
          sv: "Sweden Connect"
        urls:
          en: https://www.swedenconnect.se/en
          sv: https://www.swedenconnect.se
      contact-persons:
        technical:
          company: "Sweden Connect"
          email-addresses:
          - operations@swedenconnect.se
        support:
          company: "Sweden Connect"
          email-addresses:
          - operations@swedenconnect.se

logging:
  level:
    se:
      swedenconnect:
        spring:
          saml: DEBUG
