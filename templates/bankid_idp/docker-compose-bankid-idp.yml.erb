version: '3.2'

services:
  pyff:
    image: docker.sunet.se/bankid-idp:<%= @imagetag %>
<% unless @resolvers.empty? -%>
    dns:
<% @resolvers.each do |resolver| -%>
      - <%= resolver %>
<% end -%>
<% end -%>
<% unless @environments.empty? -%>
    environment:
<% @environments.each do |environment| -%>
      - <%= environment %>
<% end -%>
<% end -%>
<% unless @volumes.empty? -%>
    volumes:
<%- @volumes.each do |extra_volume| -%>
      - "<%= extra_volume %>"
<%- end -%>
      - "<%= @port %>:<%= @port %>"
<% end -%>
<% unless @ports.empty? -%>
    ports:
<%- @ports.each do |port| -%>
      - "<%= port %>"
<%- end -%>
<% end -%>
