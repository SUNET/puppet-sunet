---
version: '2'
services:
  pypiserver:
    image: docker.sunet.se/eduid/pypiserver:stable
    expose:
      - 8080
    volumes:
      - /opt/pypi/pypiserver/etc/start.sh:/start.sh
      - /opt/pypi/chroot/incoming:/opt/eduid/pypiserver/packages
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro

  nginx: 
    image: docker.sunet.se/eduid/nginx:latest
    ports:
      - 80:80
      - 443:443
    volumes:
      - /opt/pypi/nginx/etc/default.conf:/etc/nginx/sites-enabled/default.conf:ro
      #- [sslcert]:/etc/nginx/ssl/<%= @fqdn %>.crt
      #- [sslkey]:/etc/nginx/ssl/<%= @fqdn %>.key
      - /var/log/nginx:/var/log/nginx
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
