services:
  etcd:
    image: <%= @docker_image %>:<%= @docker_tag %>
    volumes:
      - <%= @base_dir %>/<%= @service_name %>/data:/data
      - <%= @base_dir %>/<%= @service_name %>/etcd.conf.yml:<%= @base_dir %>/<%= @service_name %>/etcd.conf.yml:ro
      - <%= @cert_file %>:<%= @cert_file %>:ro
      - <%= @key_file %>:<%= @key_file %>:ro
      - <%= @trusted_ca_file %>:<%= @trusted_ca_file %>:ro

    ports:
    <%- @ports.each do |port| -%>
      - "<%= port %>"
<%- end -%>
    command:
      - "--config-file=<%= @base_dir %>/<%= @service_name%>/etcd.conf.yml"
