#!/bin/bash

VERSION=v6

BLACKLIST=/etc/checkrestart-blacklist.local



if [ -f $BLACKLIST ]; then

    OUTPUT=`/usr/sbin/checkrestart -b $BLACKLIST 2>&1`

else

    OUTPUT=`/usr/sbin/checkrestart 2>&1`

fi



RESULT=`echo $OUTPUT | grep Found | awk '{print $2}'`



if [ -z $RESULT ]; then

    echo "CRITICAL - No data ($VERSION)"

    exit 2

fi



if [ $RESULT -eq 0 ] ; then

    echo "OK - no service or process to restart ($VERSION)"

    exit 0

else

    echo $OUTPUT > /var/log/checkrestart.log

    echo "CRITICAL: $RESULT services or processes to restart ($VERSION)"

    exit 2

fi
